<?xml version="1.0"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	<?define EncodingConvertersPath = "..\packages\Encoding-Converters-Core.0.0.6\MergeModules" ?>
	<Fragment Id="MergeModulesFragment">
		<Property Id='MergeModulesFragment' Value='1'/>
		<DirectoryRef Id="SIL">
			<?if $(var.Platform) = x64 ?>
			<Merge Id="TECkit_DLLs" Language="1033" SourceFile="$(var.EncodingConvertersPath)\TECkit64bitDLLsMM.msm" DiskId="1"/>
			<Merge Id="Set_Path_EC" Language="1033" SourceFile="externalencodingconverters\64bit\SetPath.msm" DiskId="1"/>
		  <?else?>
			<Merge Id="TECkit_DLLs" Language="1033" SourceFile="$(var.EncodingConvertersPath)\TECkitDLLsMM.msm" DiskId="1"/>
			<Merge Id="Set_Path_EC" Language="1033" SourceFile="externalencodingconverters\SetPath.msm" DiskId="1"/>
			<?endif?>
		</DirectoryRef>
		<DirectoryRef Id="INSTALLDIR">
			<?if $(var.Platform) = x64 ?>
			<Merge Id="PerlEC" Language="1033" SourceFile="$(var.EncodingConvertersPath)\PerlEc64bitMM.msm" DiskId="1"/>
			<Merge Id="PythonEC" Language="1033" SourceFile="$(var.EncodingConvertersPath)\PythonEc64bitMM.msm" DiskId="1"/>
			<Merge Id="CC_DLL" Language="1033" SourceFile="$(var.EncodingConvertersPath)\CcDLLs64bitMM.msm" DiskId="1"/>
			<Merge Id="EncConverters_Common" Language="1033" SourceFile="$(var.EncodingConvertersPath)\EC_40_64bit_MM.msm" DiskId="1"/>
			<?else?>
			<Merge Id="PerlEC" Language="1033" SourceFile="$(var.EncodingConvertersPath)\PerlEcMM.msm" DiskId="1"/>
			<Merge Id="PythonEC" Language="1033" SourceFile="$(var.EncodingConvertersPath)\PythonEcMM.msm" DiskId="1"/>
			<Merge Id="CC_DLL" Language="1033" SourceFile="$(var.EncodingConvertersPath)\CcDLLsMM.msm" DiskId="1"/>
			<Merge Id="EncConverters_Common" Language="1033" SourceFile="$(var.EncodingConvertersPath)\EC_40_MM.msm" DiskId="1"/>
		  <?endif?>
		</DirectoryRef>
		<DirectoryRef Id="SystemFolder">
			<?if $(var.Platform) = x64 ?>
			<!-- Gecko requires VC120 and FLEx built on VS2015 should as well -->
			<Merge Id="CRT" Language="1033" SourceFile="ExternalMergeModules\Microsoft_VC120_CRT_x64.msm" DiskId="1"/>
			<Merge Id="MFC" Language="1033" SourceFile="ExternalMergeModules\Microsoft_VC120_MFC_x64.msm" DiskId="1"/>
			<!-- The CRT90 merge module is needed only for the PythonEC (using Python 2.7) merge module: -->
			<Merge Id="CRT90" Language="1033" SourceFile="ExternalMergeModules\Microsoft_VC90_CRT_x86_x64.msm" DiskId="1"/>
			<!-- Review: If we need ATL for FLEx itself then we need to find a VC120 version of the MM and install it-->
			<!-- <Merge Id="ATL" Language="1033" SourceFile="ExternalMergeModules\Microsoft_VC100_ATL_x64.msm" DiskId="1"/> ICE80 error -->
			<?else?>
			<!-- Gecko requires VC120 and FLEx built on VS2015 should as well -->
			<Merge Id="MFC" Language="1033" SourceFile="ExternalMergeModules\Microsoft_VC120_MFC_x86.msm" DiskId="1"/>
			<Merge Id="CRT" Language="1033" SourceFile="ExternalMergeModules\Microsoft_VC120_CRT_x86.msm" DiskId="1"/>
			<!-- The CRT90 merge module is needed only for the PythonEC (using Python 2.7) merge module: -->
			<Merge Id="CRT90" Language="1033" SourceFile="ExternalMergeModules\Microsoft_VC90_CRT_x86.msm" DiskId="1"/>
			<!-- Review: If we need ATL for FLEx its self then we need to find a VC120 version of the MM and install it-->
			<Merge Id="ATL" Language="1033" SourceFile="ExternalMergeModules\Microsoft_VC100_ATL_x86.msm" DiskId="1"/>
			<?endif?>
		</DirectoryRef>
		<DirectoryRef Id="System64Folder">
			<?if $(var.Platform) = x64 ?>
			<Merge Id="CRT100" Language="1033" SourceFile="ExternalMergeModules\Microsoft_VC100_CRT_x64.msm" DiskId="1"/>
			<?endif?>
		</DirectoryRef>
	</Fragment>
</Wix>
